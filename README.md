# RIR_estimator

Author: SebastiÃ£o Quintas

This repository presents a deep learning approach to the automatic estimation of absorption coefficients as well as room geometry (shoebox model) from room-impulse-responses (RIR). The system is trained using virtually generated RIR files (wav), using pyroomacoustics to simulate different shoebox rooms with varying absorption levels.

The main recipe can be found divided in two parts:

The first corresponds to the corpus creation: 
	
	$ python create_corpus.py

This script creates a corpus based on the virtual room images generated by pyroomacoustics. Each RIR file is generated using a random room geometry, where for each surface (4 distinct walls, floor and ceiling) a random material is sampled. The list (materials_index_pra.csv) contains 72 different materials obtained from pyroomacoustics website, with the absorption coefficients for the first six bands (0.125, 0.250. 0.500. 1.0, 2.0 and 4.0 kHz).

The second part of the global recipe corresponds to the train/test procedure:
	
	$ python train.py

This script uses the corpus generated previously and separates it into the different manifests (train, val and test). The dataloaders can be found described in the load.py file, while the model and lightning module can be found on the model.py script.

Progress can be tracked using tensorboard:

	$ tensorboard --logdir=lightning_logs/

The full parameter list for both the corpus creation and system training can be found in the ./configs/parameters.yaml file. Helper functions can be found under the resources directory (e.g. plot_rir.py to plot the waveform of a given room-impulse-response file).

Repository structure:

	> configs/
		- parameters.yaml
	> data/
		> /manifests/
		> /rir_clips/
	> dataloader/
		- load.py
	> models/
		- model.py
	> resources/
		- materials_index_pra.csv
		- burst_balloon.wav
	- README.md
	- .gitignore
	- requirements.txt
	- create_corpus.py
	- train.py



